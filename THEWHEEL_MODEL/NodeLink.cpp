//////////////////////////////////////////////////////////////////////
// NodeLink.cpp: implementation of the CNodeLink class.
//
// Copyright (C) 1999-2002 Derek Graham Lane
// $Id$
// U.S. Patent Pending
//////////////////////////////////////////////////////////////////////

// pre-compiled headers
#include "stdafx.h"

// class declaration
#include "NodeLink.h"

// the CNode
#include "Node.h"

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////
// CNodeLink::CNodeLink
// 
// constructs a CNodeLink to the given target, with the given weight
//////////////////////////////////////////////////////////////////////
CNodeLink::CNodeLink(CNode *pToNode, REAL weight)
	: m_pTarget(pToNode),
		m_weight(weight),
		m_bHasPropagated(TRUE)
		// initialize to HasPropagated to prevent immediate 
		//		propagation
{
}	// CNodeLink::CNodeLink


//////////////////////////////////////////////////////////////////////
// CNodeLink::~CNodeLink
// 
// destroys this node link
//////////////////////////////////////////////////////////////////////
CNodeLink::~CNodeLink()
{
}	// CNodeLink::~CNodeLink


//////////////////////////////////////////////////////////////////////
// implements CNodeLink's dynamic serialization
//////////////////////////////////////////////////////////////////////
IMPLEMENT_SERIAL(CNodeLink, CObject, 1)


//////////////////////////////////////////////////////////////////////
// CNodeLink::GetWeight
// 
// returns the weight of this link
//////////////////////////////////////////////////////////////////////
REAL CNodeLink::GetWeight() const
{
	return m_weight;

}	// CNodeLink::GetWeight


//////////////////////////////////////////////////////////////////////
// CNodeLink::SetWeight
// 
// sets the weight of this link
//////////////////////////////////////////////////////////////////////
void CNodeLink::SetWeight(REAL newWeight)
{
	m_weight = newWeight;

}	// CNodeLink::SetWeight


//////////////////////////////////////////////////////////////////////
// CNodeLink::GetTarget
// 
// returns the target of this link
//////////////////////////////////////////////////////////////////////
CNode *CNodeLink::GetTarget()
{
	return m_pTarget;

}	// CNodeLink::GetTarget


//////////////////////////////////////////////////////////////////////
// CNodeLink::GetTarget const
// 
// returns the target of this link as a const pointer
//////////////////////////////////////////////////////////////////////
const CNode *CNodeLink::GetTarget() const
{
	return m_pTarget;

}	// CNodeLink::GetTarget const


//////////////////////////////////////////////////////////////////////
// CNodeLink::SetTarget
// 
// sets the target of this link
//////////////////////////////////////////////////////////////////////
void CNodeLink::SetTarget(CNode *pTarget)
{
	m_pTarget = pTarget;

}	// CNodeLink::SetTarget


//////////////////////////////////////////////////////////////////////
// CNodeLink::HasPropagated
// 
// flag to indicate that propagation has occurred through the link
//////////////////////////////////////////////////////////////////////
BOOL CNodeLink::HasPropagated() const
{
	return m_bHasPropagated;

}	// CNodeLink::HasPropagated


//////////////////////////////////////////////////////////////////////
// CNodeLink::SetHasPropagated
// 
// sets/clears flag to indicate propagation
//////////////////////////////////////////////////////////////////////
void CNodeLink::SetHasPropagated(BOOL bPropagated)
{
	m_bHasPropagated = bPropagated;

}	// CNodeLink::SetHasPropagated


//////////////////////////////////////////////////////////////////////
// CNodeLink::Serialize
// 
// serializes the node link
//////////////////////////////////////////////////////////////////////
void CNodeLink::Serialize(CArchive &ar)
{
	if (ar.IsLoading())
	{
		// load the values
		float weight;
		ar >> weight;
		m_weight = (REAL) weight;
		ar >> m_pTarget;
	}
	else
	{
		// store the values
		ar << (float) m_weight;
		ar << m_pTarget;
	}

}	// CNodeLink::Serialize
